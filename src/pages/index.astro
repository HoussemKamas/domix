---
import Layout from '../layouts/Layout.astro';
import fs from 'fs';
import path from 'path';

const dataPath = path.join(process.cwd(), 'src/data/domix.json');

type DomixData = {
  domains: any[];
  prompts: any[];
  code: any[];
  extensions: any[];
};

let data: DomixData = { domains: [], prompts: [], code: [], extensions: [] };

try {
  const raw = fs.readFileSync(dataPath, 'utf-8');
  const parsed = JSON.parse(raw);

  data = {
    domains: parsed.domains ?? [],
    prompts: parsed.prompts ?? [],
    code: parsed.code ?? [],
    extensions: parsed.extensions ?? []
  };
} catch (e) {
  console.error('Failed to read domix.json', e);
}

const byIdDesc = (a: any, b: any) => Number(b.id ?? 0) - Number(a.id ?? 0);

const latestDomains    = [...data.domains].sort(byIdDesc).slice(0, 3);
const latestPrompts    = [...data.prompts].sort(byIdDesc).slice(0, 3);
const latestCode       = [...data.code].sort(byIdDesc).slice(0, 3);
const latestExtensions = [...data.extensions].sort(byIdDesc).slice(0, 3);
---

<Layout title="DOMIX - Future Marketplace">
  <style>
    :root{
      --bg-dark:#050505;
      --panel: rgba(255,255,255,.04);
      --panel-border: rgba(255,255,255,.10);
      --text-dim:#a0a0a0;

      --neon-blue:#00f3ff;
      --neon-purple:#bc13fe;
      --neon-green:#00ff88;
      --neon-orange:#ff9d00;

      --radius: 22px;
      --edge-gap: 24px;

      --moveDur: 340ms;

      --panelDelay: 80ms;
      --domainsDelay: 240ms;
      --riseDelay: 220ms;
      --wheelSpeed: 22s;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg-dark);
      color:#fff;
      overflow-x:hidden;
      transition: background .45s ease;
    }

    /* background image per domain */
    .bg-photo{
      position: fixed;
      inset:0;
      z-index:-5;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      opacity:0;
      transform: scale(1.03);
      filter: brightness(0.7) saturate(1.1);
      transition: opacity .45s ease-out, transform .6s ease-out;
    }
    body.domain-bg-on .bg-photo{
      opacity:1;
      transform: scale(1);
    }

    /* grid background */
    .cyber-grid{
      position: fixed;
      inset:0;
      background-image:
        linear-gradient(rgba(0, 243, 255, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 243, 255, 0.03) 1px, transparent 1px);
      background-size: 52px 52px;
      z-index:-3;
      perspective: 600px;
      transform-style: preserve-3d;
      animation: gridMove 18s linear infinite;
      opacity: .9;
      transition: opacity .35s ease;
    }
    @keyframes gridMove{
      0% { transform: translateY(0) rotateX(18deg); }
      100%{ transform: translateY(60px) rotateX(18deg); }
    }

    /* light overlay */
    .bg-overlay{
      position: fixed;
      inset:0;
      z-index:-4;
      pointer-events:none;
      transition: .45s ease;
      background: radial-gradient(circle at 50% 30%, rgba(255,255,255,0.04), transparent 55%);
    }

    /* floating text background */
    .bg-streams{
      position: fixed;
      inset:0;
      pointer-events:none;
      z-index:-2;
      overflow:hidden;
      mix-blend-mode: screen;
    }
    .bg-chip{
      position:absolute;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 11px;
      letter-spacing: .08em;
      white-space: nowrap;
      color: rgba(0,243,255,.38);
      text-shadow:
        0 0 8px rgba(0,243,255,.6),
        0 0 22px rgba(0,243,255,.35);
      opacity:0;
      transform: translate3d(0,0,0);
      animation: chipFloat 8s linear infinite;
    }
    .bg-chip.alt{
      color: rgba(188,19,254,.35);
      text-shadow:
        0 0 8px rgba(188,19,254,.7),
        0 0 22px rgba(188,19,254,.35);
    }
    .bg-chip.code{
      color: rgba(0,255,136,.35);
      text-shadow:
        0 0 8px rgba(0,255,136,.7),
        0 0 22px rgba(0,255,136,.35);
    }

    @keyframes chipFloat{
      0%{
        opacity:0;
        transform: translate3d(0,18px,0) scale(.9);
        filter: blur(2px);
      }
      8%{
        opacity:.9;
        filter: blur(0px);
      }
      50%{
        opacity:.75;
      }
      92%{
        opacity:0;
        filter: blur(1px);
      }
      100%{
        transform: translate3d(0,-52px,0) scale(1.02);
      }
    }

    /* overlay glow by hovered card */
    body:has(.card-domains:hover) .bg-overlay{
      background: radial-gradient(circle at 12% 50%, rgba(0,243,255,.22), transparent 65%);
    }
    body:has(.card-prompts:hover) .bg-overlay{
      background: radial-gradient(circle at 50% 50%, rgba(188,19,254,.20), transparent 70%);
    }
    body:has(.card-code:hover) .bg-overlay{
      background: radial-gradient(circle at 80% 50%, rgba(0,255,136,.20), transparent 70%);
    }
    body:has(.card-extension:hover) .bg-overlay{
      background: radial-gradient(circle at 70% 65%, rgba(0,243,255,.20), transparent 65%);
    }
    body:has(.card-contact:hover) .bg-overlay{
      background: radial-gradient(circle at 90% 50%, rgba(255,157,0,.22), transparent 65%);
    }

    .hero{
      min-height:100vh;
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      padding: 60px 18px;
      position: relative;
      isolation:isolate;
    }
    .hero h1{
      font-size: clamp(3rem, 7vw, 6rem);
      margin:0;
      letter-spacing: 6px;
      text-shadow: 0 0 22px rgba(255,255,255,.35);
      animation: pulseTitle 3s infinite ease-in-out;
    }
    @keyframes pulseTitle{
      0%,100%{ text-shadow:0 0 22px rgba(255,255,255,.35); }
      50%{ text-shadow: 0 0 50px rgba(255,255,255,.7), 0 0 110px rgba(255,255,255,.35); }
    }
    .tagline{
      margin: 10px 0 55px;
      color: var(--text-dim);
      text-transform: uppercase;
      letter-spacing: 3px;
      font-size: 1.05rem;
      text-align:center;
      max-width: 760px;
    }

    .stage{
      width:min(1220px, 92vw);
      position: relative;
      display:flex;
      justify-content:center;
    }

    .menu-container{
      display:flex;
      gap: 22px;
      flex-wrap: nowrap;
      justify-content:center;
      align-items:stretch;
      width: 100%;
      position: relative;
    }

    .menu-card{
      width: 210px;
      height: 255px;
      background: rgba(255,255,255,.04);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: var(--radius);
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      cursor:pointer;
      position:relative;
      overflow:hidden;
      transition: transform .35s ease, box-shadow .35s.ease, border-color .35s ease, opacity .2s ease;
      backdrop-filter: blur(6px);
      user-select:none;
    }
    .menu-card::before{
      content:"";
      position:absolute;
      inset:-40%;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.08), transparent 55%);
      transform: rotate(12deg);
      opacity:.55;
      transition: opacity .35s ease;
    }
    .menu-card:hover::before{ opacity:.9; }
    .menu-card:hover{
      box-shadow: 0 0 40px rgba(0,0,0,.7);
      transform: translateY(-10px);
    }

    .menu-card h3{
      margin: 16px 0 0;
      font-size: 1.15rem;
      letter-spacing: .6px;
      z-index: 2;
    }
    .sub{
      margin-top: 8px;
      color: rgba(255,255,255,.65);
      font-size: .92rem;
      z-index:2;
      text-align:center;
      padding: 0 10px;
    }

    /* Domains logo */
    .tld-logo{
      display:flex;
      align-items:baseline;
      gap: 3px;
      font-weight: 950;
      font-size: 2.25rem;
      letter-spacing: .5px;
      z-index:2;
      line-height:1;
      padding: 10px 14px;
      border-radius: 16px;
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.10);
      box-shadow: 0 0 18px rgba(0,0,0,.6);
      transition: box-shadow .25s.ease, border-color .25s.ease;
    }
    .tld-dot{ color:#fff; opacity:.95; transform: translateY(-1px); }
    .tld-ext{
      color: var(--neon-blue);
      text-shadow: 0 0 18px rgba(0,243,255,.35);
      min-width: 4ch;
      display:inline-block;
      transition: opacity .2s ease, text-shadow .25s.ease;
    }
    .card-domains:hover .tld-logo{
      border-color: rgba(0,243,255,.35);
      box-shadow: 0 0 25px rgba(0,243,255,.4), 0 0 80px rgba(0,243,255,.18);
    }
    .card-domains:hover .tld-ext{
      text-shadow: 0 0 28px rgba(0,243,255,.7), 0 0 90px rgba(0,243,255,.42);
    }

    /* Prompt */
    .prompt-sky{
      position: relative;
      width: 150px;
      height: 54px;
      border-radius: 16px;
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.10);
      z-index:2;
      overflow:hidden;
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow: 0 0 18px rgba(0,0,0,.6);
      transition: box-shadow .25s ease, border-color .25s ease;
    }
    .card-prompts:hover .prompt-sky{
      border-color: rgba(188,19,254,.35);
      box-shadow: 0 0 25px rgba(188,19,254,.5), 0 0 80px rgba(188,19,254,.22);
    }
    .prompt-float{
      position:absolute;
      left: 14px;
      right: 14px;
      bottom: -10px;
      font-weight: 950;
      letter-spacing: 1px;
      font-size: 1.45rem;
      white-space: nowrap;
      color:#fff;
      text-shadow: 0 0 16px rgba(188,19,254,.22);
      opacity: 0;
      transform: translateY(0);
    }
    .prompt-caret{
      display:inline-block;
      width: 10px;
      height: 14px;
      background: var(--neon-purple);
      box-shadow: 0 0 12px rgba(188,19,254,.35);
      margin-left: 6px;
      animation: blink .9s infinite;
      transform: translateY(2px);
    }
    @keyframes blink{ 50%{ opacity:.2; } }

    /* Code */
    .laptop{
      width: 130px;
      height: 90px;
      border-radius: 14px;
      background: rgba(0,0,0,.30);
      border: 1px solid rgba(255,255,255,.12);
      position: relative;
      z-index:2;
      overflow:hidden;
      box-shadow: 0 0 18px rgba(0,0,0,.6);
      transition: box-shadow .25s ease, border-color .25s ease;
    }
    .card-code:hover .laptop{
      border-color: rgba(0,255,136,.35);
      box-shadow: 0 0 25px rgba(0,255,136,.45), 0 0 80px rgba(0,255,136,.20);
    }
    .laptop::after{
      content:"";
      position:absolute;
      left: 50%;
      bottom: -16px;
      transform: translateX(-50%);
      width: 160px;
      height: 28px;
      border-radius: 18px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      box-shadow: 0 10px 26px rgba(0,0,0,.25);
    }
    .screen{
      position:absolute;
      inset: 10px 10px 18px 10px;
      border-radius: 10px;
      background: rgba(0,0,0,.65);
      border: 1px solid rgba(255,255,255,.10);
      padding: 10px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 11px;
      line-height: 1.35;
      color: rgba(255,255,255,.90);
      overflow:hidden;
    }
    .cursor{
      display:inline-block;
      width: 8px;
      height: 12px;
      margin-left: 2px;
      background: var(--neon-green);
      box-shadow: 0 0 12px rgba(0,255,136,.35);
      animation: blink .9s infinite;
      transform: translateY(2px);
    }
    .code-line{
      color: rgba(0,255,136,.92);
      text-shadow: 0 0 10px rgba(0,255,136,.22);
      white-space: nowrap;
      overflow: hidden;
      display:inline-block;
      max-width: 100%;
    }

    /* Extension icon */
    .card-extension .ext-orb {
      position: relative;
      width: 84px;
      height: 84px;
      border-radius: 20px;
      display: grid;
      place-items: center;
      background:
        linear-gradient(135deg, rgba(0,243,255,.16), rgba(188,19,254,.18)),
        radial-gradient(circle at 18% 22%, rgba(0,243,255,.75), transparent 55%),
        radial-gradient(circle at 82% 78%, rgba(188,19,254,.85), transparent 55%);
      box-shadow:
        0 0 28px rgba(0,243,255,.35),
        0 0 60px rgba(188,19,254,.35);
      overflow: hidden;
      border: 1px solid rgba(255,255,255,.12);
    }

    .card-extension .ext-window {
      position: relative;
      width: 68px;
      height: 46px;
      border-radius: 12px;
      background: rgba(0,0,0,.76);
      border: 1px solid rgba(255,255,255,.18);
      box-shadow: 0 0 18px rgba(0,0,0,.85);
      overflow: hidden;
    }

    .card-extension .ext-window-top {
      position: absolute;
      inset: 0 0 auto 0;
      height: 12px;
      background: linear-gradient(90deg, rgba(0,243,255,.55), rgba(188,19,254,.65));
      display: flex;
      align-items: center;
      padding-inline: 6px;
      gap: 4px;
    }

    .card-extension .ext-dot {
      width: 4px;
      height: 4px;
      border-radius: 999px;
      background: rgba(0,0,0,.8);
      opacity: .8;
    }

    .card-extension .ext-body {
      position: absolute;
      inset: 12px 4px 4px 4px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .card-extension .ext-piece {
      position: relative;
      width: 26px;
      height: 26px;
      border-radius: 8px;
      background: linear-gradient(135deg, rgba(0,243,255,.9), rgba(0,255,136,.95));
      box-shadow:
        0 0 16px rgba(0,243,255,.55),
        0 0 30px rgba(0,255,136,.45);
      clip-path: path("M6 0 H18 Q22 0 22 4 V8 Q26 8 26 12 Q26 16 22 16 V20 Q22 24 18 24 H6 Q2 24 2 20 V16 Q-2 16 -2 12 Q-2 8 2 8 V4 Q2 0 6 0 Z");
      animation: extFloat 2.4s ease-in-out infinite;
    }

    .card-extension .ext-plus {
      position: absolute;
      inset: 0;
      display: grid;
      place-items: center;
      color: #001510;
      font-weight: 900;
      font-size: 0.75rem;
      text-shadow: 0 0 10px rgba(255,255,255,.45);
    }

    @keyframes extFloat {
      0%   { transform: translateY(0) scale(1); }
      50%  { transform: translateY(-4px) scale(1.03); }
      100% { transform: translateY(0) scale(1); }
    }

    .card-extension:hover .ext-orb {
      box-shadow:
        0 0 30px rgba(0,243,255,.7),
        0 0 80px rgba(188,19,254,.65);
      transform: translateY(-4px);
      transition: transform .25s ease, box-shadow .25s ease;
    }

    /* Contact icon */
    .env-box{
      width: 76px;
      height: 56px;
      z-index: 2;
      filter: drop-shadow(0 14px 22px rgba(0,0,0,.25));
      transition: filter .25s ease;
    }
    .card-contact:hover .env-box{
      filter: drop-shadow(0 0 22px rgba(255,157,0,.25)) drop-shadow(0 0 70px rgba(255,157,0,.18));
    }
    .env-svg{ width: 100%; height: 100%; display:block; }
    .env-flap{
      transform-box: fill-box;
      transform-origin: top center;
      transform: rotateX(0deg);
      transition: transform .55s ease;
    }

    /* PANELS */

    .contact-panel{
      position: fixed;
      left: calc(var(--edge-gap) + 210px + 18px);
      top: 50%;
      transform: translateY(-50%) translateX(-18px);
      width: min(560px, 92vw);
      padding: 18px 18px 16px;
      border-radius: 30px;
      background:
        radial-gradient(circle at 15% 10%, rgba(255,255,255,.10), transparent 45%),
        linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border: 1px solid rgba(255,255,255,.08);
      backdrop-filter: blur(18px) saturate(120%);
      box-shadow:
        0 0 0 1px rgba(255,255,255,.03),
        0 0 80px rgba(255,157,0,.10),
        0 25px 90px rgba(0,0,0,.55);
      z-index: 95;
      opacity: 0;
      pointer-events: none;
      transition: opacity .22s ease, transform .22s ease;
    }
    .contact-panel .ttl{
      font-weight: 950;
      letter-spacing: .6px;
      font-size: 1.06rem;
      margin-bottom: 12px;
    }

    .contact-actions{
      display:flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .contact-pill{
      flex: 1 1 240px;
      display:flex;
      align-items:center;
      gap: 12px;
      padding: 14px 14px;
      border-radius: 999px;
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.08);
      text-decoration:none;
      color:#fff;
      min-height: 58px;
      transition: transform .18s ease, border-color .18s ease, box-shadow .18s ease, background .18s.ease;
    }
    .contact-pill:hover{
      transform: translateY(-2px);
      background: rgba(0,0,0,.22);
    }

    .pill-ico{
      width: 40px;
      height: 40px;
      display:grid;
      place-items:center;
      border-radius: 999px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
    }

    .pill-gmail:hover{
      border-color: rgba(0,243,255,.22);
      box-shadow: 0 0 0 1px rgba(0,243,255,.10), 0 0 48px rgba(0,243,255,.16);
    }
    .pill-wa:hover{
      border-color: rgba(0,255,136,.26);
      box-shadow: 0 0 0 1px rgba(0,255,136,.10), 0 0 60px rgba(0,255,136,.18);
    }

    .pill-text .k{
      font-weight: 900;
      opacity: .78;
      font-size: .78rem;
      letter-spacing: .5px;
      text-transform: uppercase;
      margin-bottom: 2px;
    }
    .pill-text .v{
      font-weight: 950;
      font-size: 1.05rem;
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
      max-width: 390px;
    }

    .domain-wall{
      position: fixed;
      left: var(--edge-gap);
      top: 50%;
      transform: translateY(-50%) translateX(-18px);
      width: min(680px, 92vw);
      height: 560px;
      padding: 18px 18px 16px;
      border-radius: 30px;
      background:
        radial-gradient(circle at 18% 15%, rgba(0,243,255,.12), transparent 42%),
        linear-gradient(180deg, rgba(255,255,255,.055), rgba(255,255,255,.02));
      border: 1px solid rgba(255,255,255,.08);
      backdrop-filter: blur(18px) saturate(120%);
      box-shadow:
        0 0 0 1px rgba(255,255,255,.03),
        0 0 110px rgba(0,243,255,.14),
        0 25px 95px rgba(0,0,0,.55);
      z-index: 90;
      opacity: 0;
      pointer-events: none;
      transition: opacity .22s ease, transform .22s.ease;
    }
    .domain-wall .head{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      padding: 2px 4px 14px;
      gap: 12px;
    }
    .domain-wall .ttl{
      font-weight:950;
      letter-spacing:.6px;
      font-size:1.08rem;
    }
    .domain-wall .hint{
      color: rgba(255,255,255,.65);
      font-size:.95rem;
    }

    .domain-rise{
      position: relative;
      height: calc(100% - 44px);
      overflow:hidden;
      border-radius: 24px;
      background: radial-gradient(circle at 20% 20%, rgba(255,255,255,.05), transparent 60%);
      border: 1px solid rgba(255,255,255,.06);
    }

    .domain-rise ul{
      list-style:none;
      margin:0;
      padding: 34px 22px;
      position:absolute;
      left:0;
      top:0;
      width:100%;
      display:flex;
      flex-direction:column;
      gap:18px;
      will-change: transform;
    }

    .domain-rise li{
      filter: drop-shadow(0 12px 18px rgba(0,0,0,.35));
    }

    .domain-rise a{
      display:inline-block;
      text-decoration:none;
      color: rgba(255,255,255,.98);
      font-weight: 950;
      letter-spacing: .2px;
      font-size: 1.95rem;
      padding: 6px 16px;
      border-radius: 999px;
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.08);
      text-shadow: 0 0 22px rgba(0,243,255,.14);
      transition: transform .18s.ease, text-shadow .18s.ease, box-shadow .18s.ease, background .18s.ease;
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
      max-width: 100%;
    }
    .domain-rise a:hover{
      transform: translateX(16px);
      text-shadow: 0 0 50px rgba(0,243,255,.25);
      box-shadow: 0 0 0 1px rgba(0,243,255,.12), 0 0 60px rgba(0,243,255,.12);
      background: rgba(0,0,0,.22);
    }

    /* FOCUS */

    body.focus-domains .menu-card:not(.card-domains),
    body.focus-contact .menu-card:not(.card-contact){
      opacity: 0;
      pointer-events: none;
      transform: scale(.96);
    }

    body.focus-domains #cardDomains,
    body.focus-contact #cardContact{
      transition: transform var(--moveDur).ease, box-shadow .35s.ease, border-color .35s.ease, opacity .2s ease;
      z-index: 110;
    }

    body.focus-domains #cardDomains{
      position: fixed;
      right: var(--edge-gap);
      top: 50%;
      transform: translateY(-50%);
    }
    body.focus-domains #cardDomains:hover{ transform: translateY(-50%); }

    body.focus-contact #cardContact{
      position: fixed;
      left: var(--edge-gap);
      top: 50%;
      transform: translateY(-50%);
    }
    body.focus-contact #cardContact:hover{ transform: translateY(-50%); }

    body.domains-panel-on .domain-wall{
      opacity: 1;
      pointer-events: auto;
      transform: translateY(-50%) translateX(0);
      transition-delay: var(--panelDelay);
    }
    body.contact-panel-on .contact-panel{
      opacity: 1;
      pointer-events: auto;
      transform: translateY(-50%) translateX(0);
      transition-delay: var(--panelDelay);
    }

    body.contact-panel-on #cardContact .env-flap{
      transform: rotateX(165deg);
      transition-delay: var(--panelDelay);
    }

    @media (max-width: 1280px){
      .menu-container{
        flex-wrap: wrap;
      }
    }

    @media (max-width: 980px){
      body.focus-domains #cardDomains,
      body.focus-contact #cardContact{
        left: 50%;
        right: auto;
        transform: translate(-50%, -50%);
      }
      .contact-panel{
        left: 50%;
        transform: translate(-50%, -50%);
        width: min(560px, 92vw);
      }
      .domain-wall{
        width: min(680px, 92vw);
      }
      .domain-rise ul{ padding-inline:16px; }
    }
  </style>

  <!-- photo layer controlled by hovered domain -->
  <div class="bg-photo" id="bgPhoto"></div>

  <div class="cyber-grid"></div>
  <div class="bg-overlay"></div>

  <!-- floating background -->
  <div class="bg-streams" id="bgStreams"></div>

  <!-- Domains panel -->
  <aside class="domain-wall" id="domainWall" aria-hidden="true">
    <div class="head">
      <div class="ttl">Featured Domains</div>
      <div class="hint">Hover â†’ Click to open</div>
    </div>
    <div class="domain-rise" id="domainRise">
      <ul id="domainRiseList">
        {latestDomains.map((item) => (
          <li>
            <a href={`/domains-details#${item.id}`} title={item.domain ?? item.name}>
              {item.domain ?? item.name}
            </a>
          </li>
        ))}
      </ul>
    </div>
  </aside>

  <!-- Contact panel -->
  <aside class="contact-panel" id="contactPanel" aria-hidden="true">
    <div class="ttl">Contact</div>

    <div class="contact-actions">
      <a class="contact-pill pill-gmail" href="mailto:houssemkamas96@gmail.com">
        <div class="pill-ico" title="Email">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M4 7.5V18.5C4 19.3 4.7 20 5.5 20H18.5C19.3 20 20 19.3 20 18.5V7.5"
              stroke="white"
              stroke-width="1.8"
              stroke-linecap="round"
            />
            <path
              d="M4.2 7.4L12 13.2L19.8 7.4"
              stroke="white"
              stroke-width="1.8"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path d="M6 6.5H18" stroke="rgba(0,243,255,.9)" stroke-width="2" stroke-linecap="round" />
          </svg>
        </div>
        <div class="pill-text">
          <div class="k">Email</div>
          <div class="v">houssemkamas96@gmail.com</div>
        </div>
      </a>

      <a
        class="contact-pill pill-wa"
        href="https://wa.me/213781302576?text=Hello%20my%20friend%2C%0AIf%20you%20have%20any%20questions%2C%20I%27m%20here%20to%20help.%0AJust%20leave%20a%20message%20and%20I%27ll%20reply%20soon.%0AThank%20you%20for%20contacting%20me.%20Have%20a%20nice%20day%21"
        target="_blank"
        rel="noopener"
      >
        <div class="pill-ico" title="WhatsApp">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M12 20.5C16.7 20.5 20.5 16.7 20.5 12C20.5 7.3 16.7 3.5 12 3.5C7.3 3.5 3.5 7.3 3.5 12C3.5 13.4 3.8 14.7 4.4 15.9L3.5 20.5L8.2 19.6C9.3 20.2 10.6 20.5 12 20.5Z"
              stroke="white"
              stroke-width="1.8"
              stroke-linejoin="round"
            />
            <path
              d="M9.3 9.2C9.6 8.7 10 8.7 10.4 8.7C10.7 8.7 11 8.7 11.2 9.1L11.8 10.3C12 10.7 11.9 11 11.6 11.3L11.2 11.7C11.7 12.8 12.6 13.6 13.7 14.1L14.1 13.7C14.4 13.4 14.7 13.3 15.1 13.5L16.4 14.1C16.8 14.3 16.8 14.7 16.8 15C16.8 15.6 16.3 16.1 15.7 16.3C15 16.6 13.9 16.5 12.3 15.7C10.8 15 9.4 13.6 8.7 12.1C7.9 10.5 7.8 9.4 8.1 8.7C8.3 8.1 8.8 7.6 9.3 7.6"
              stroke="rgba(0,255,136,.95)"
              stroke-width="1.7"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </div>
        <div class="pill-text">
          <div class="k">WhatsApp</div>
          <div class="v">+213781302576</div>
        </div>
      </a>
    </div>
  </aside>

  <section class="hero">
    <h1>DOMIX</h1>
    <p class="tagline">The Digital Asset Marketplace</p>

    <div class="stage" id="stage">
      <div class="menu-container" id="menuContainer">
        <!-- Domains -->
        <div class="menu-card card-domains" id="cardDomains">
          <div class="tld-logo">
            <span class="tld-dot">.</span><span class="tld-ext" id="tldExt">com</span>
          </div>
          <h3>Domains</h3>
          <div class="sub">Browse brand-ready names</div>
        </div>

        <!-- Prompts -->
        <div class="menu-card card-prompts" id="cardPrompts">
          <div class="prompt-sky">
            <div class="prompt-float" id="promptFloat"></div>
          </div>
          <h3>Prompts</h3>
          <div class="sub">Ready-to-use ideas</div>
        </div>

        <!-- Code -->
        <div class="menu-card card-code" id="cardCode">
          <div class="laptop">
            <div class="screen">
              <span class="code-line" id="codeTyping"></span><span class="cursor"></span>
            </div>
          </div>
          <h3>Code</h3>
          <div class="sub">Snippets & templates</div>
        </div>

        <!-- Extension -->
        <div class="menu-card card-extension" id="cardExtension">
          <div class="ext-orb">
            <div class="ext-window">
              <div class="ext-window-top">
                <span class="ext-dot"></span>
                <span class="ext-dot"></span>
                <span class="ext-dot"></span>
              </div>
              <div class="ext-body">
                <div class="ext-piece">
                  <span class="ext-plus">EXT</span>
                </div>
              </div>
            </div>
          </div>
          <h3>Extension</h3>
          <div class="sub">Browser add-on</div>
        </div>

        <!-- Contact -->
        <div class="menu-card card-contact" id="cardContact">
          <div class="env-box">
            <svg class="env-svg" viewBox="0 0 120 90" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <defs>
                <linearGradient id="paper" x1="0" x2="0" y1="0" y2="1">
                  <stop offset="0" stop-color="#ffffff" />
                  <stop offset="1" stop-color="#f1f1f1" />
                </linearGradient>
              </defs>
              <rect x="10" y="18" width="100" height="60" rx="14" fill="url(#paper)" />
              <path d="M18 26 L60 52 L102 26" fill="none" stroke="rgba(0,0,0,0.08)" stroke-width="3" />
              <g class="env-flap">
                <path d="M12 22 Q60 6 108 22 L60 54 Z" fill="#ffffff" stroke="rgba(0,0,0,0.08)" stroke-width="2" />
              </g>
              <path d="M12 76 L60 48 L108 76" fill="#f6f6f6" stroke="rgba(0,0,0,0.08)" stroke-width="2" />
              <circle cx="78" cy="64" r="10" fill="#b30000" opacity="0.95" />
              <circle cx="78" cy="64" r="6" fill="#d10000" opacity="0.85" />
              <path d="M75 64 L78 61 L81 64 L78 67 Z" fill="#ffdddd" opacity="0.75" />
            </svg>
          </div>
          <h3>Contact</h3>
          <div class="sub">Reach out fast</div>
        </div>
      </div>
    </div>
  </section>

  <script is:inline>
    (function() {
      'use strict';
      
      function initApp() {
        // TLD animation
        const tldExtEl = document.getElementById("tldExt");
        if (tldExtEl) {
          const tlds = ["com","net","org","xyz"];
          let tldIndex = 0;
          setInterval(() => {
            tldIndex = (tldIndex + 1) % tlds.length;
            tldExtEl.style.opacity = "0";
            setTimeout(() => {
              tldExtEl.textContent = tlds[tldIndex];
              tldExtEl.style.opacity = "1";
            }, 140);
          }, 1100);
        }

        // Domains wheel
        const listEl = document.getElementById("domainRiseList");
        const riseEl = document.getElementById("domainRise");

        if (listEl && riseEl) {
          let autoY = 0;
          let autoSpeed = 0.35;
          let autoPaused = false;
          let lastTime = null;
          let contentHeight = 0;
          let halfHeight = 0;

          const contentHeightInit = () => {
            contentHeight = listEl.scrollHeight;
            halfHeight = contentHeight / 2;
          };

          function measureHeights(){
            contentHeightInit();
          }
          measureHeights();
          window.addEventListener("resize", measureHeights);

          function rafLoop(timestamp){
            if (!lastTime) lastTime = timestamp;
            const dt = timestamp - lastTime;
            lastTime = timestamp;

            if (!autoPaused && document.body.classList.contains("domains-rise-on")){
              autoY -= autoSpeed * (dt / 16);
              if (Math.abs(autoY) >= halfHeight){
                autoY += halfHeight;
              }
              listEl.style.transform = "translateY(" + autoY + "px)";
            }
            requestAnimationFrame(rafLoop);
          }
          requestAnimationFrame(rafLoop);

          riseEl.addEventListener("wheel", (e) => {
            e.preventDefault();
            autoPaused = true;
            const delta = e.deltaY;
            autoY -= delta;
            if (Math.abs(autoY) >= halfHeight){
              autoY += (autoY > 0 ? -1 : 1) * halfHeight;
            }
            listEl.style.transform = "translateY(" + autoY + "px)";

            clearTimeout(riseEl._wheelTimeout);
            riseEl._wheelTimeout = setTimeout(() => {
              autoPaused = false;
            }, 2000);
          }, { passive:false });
        }

        // floating background text
        const bgStreams = document.getElementById("bgStreams");
        if (bgStreams) {
          const codeSnips = [
            "fetch('/api/domains')",
            "deploy('edge-functions')",
            "async mintPrompt() { }",
            "const lead = qualify(domain)",
            "if(offer > floor) accept();"
          ];
          const promptWords = ["BRAND", "LEADS", "SYSTEM PROMPT", "AGENT", "FUNNEL"];
          const domainWords = [
            "BostonCPAFirm.com",
            "HomebuyersDubai.com",
            "HomebuyersToronto.com",
            "TopRealtorOrlando.com"
          ];

          function spawnChips(count){
            for(let i=0;i<count;i++){
              const el = document.createElement("span");
              el.classList.add("bg-chip");
              const mode = Math.random();
              if (mode < .33) el.classList.add("code");
              else if (mode < .66) el.classList.add("alt");

              const pickArr = mode < .33 ? codeSnips : (mode < .66 ? domainWords : promptWords);
              el.textContent = pickArr[Math.floor(Math.random()*pickArr.length)];

              const x = Math.random()*100;
              const y = Math.random()*100;
              const delay = Math.random()*8;
              const duration = 6 + Math.random()*6;

              el.style.left = x + "%";
              el.style.top = y + "%";
              el.style.animationDuration = duration + "s";
              el.style.animationDelay = (-delay) + "s";

              bgStreams.appendChild(el);
            }
          }
          spawnChips(28);
        }

        // domain-specific background photos
        const bgPhoto = document.getElementById("bgPhoto");
        if (bgPhoto && listEl && riseEl) {
          const domainBgMap = {
            "bostoncpafirm.com":   "photo/BostonCPAFirm.png",
            "homebuyersdubai.com": "photo/HomebuyersDubai.png",
            "homebuyerstoronto.com":"photo/HomebuyersToronto.png",
            "toprealtororlando.com":"photo/TopRealtorOrlando.png",
            "lasvegasleadgen.com": "photo/LasVegasLeadGen.png",
            "floridavac.com":      "photo/floridavac.png",
            "credentialleak.com":  "photo/CredentialLeak.png",
            "dentalbellevue.com":  "photo/DentalBellevue.png",
            "sanjoseroofs.com":    "photo/SanJoseRoofs.png"
          };

          function applyDomainBg(domainText){
            const key = domainText.trim().toLowerCase();
            const img = domainBgMap[key];
            if (!img) return;
            document.body.classList.add("domain-bg-on");
            bgPhoto.style.backgroundImage = "url('" + img + "')";
          }
          function clearDomainBg(){
            document.body.classList.remove("domain-bg-on");
            bgPhoto.style.backgroundImage = "";
          }

          const domainLinks = listEl.querySelectorAll("a");
          domainLinks.forEach(a => {
            const name = a.textContent;
            a.addEventListener("mouseenter", () => applyDomainBg(name));
          });
          riseEl.addEventListener("mouseleave", clearDomainBg);
        }

        // prompt typing
        const promptFloat = document.getElementById("promptFloat");
        if (promptFloat) {
          const promptWordsUI = ["PROMPT", "IDEA", "SYSTEM", "CHAIN", "VISION"];
          let pw = 0;
          function runPrompt(){
            const word = promptWordsUI[pw];
            promptFloat.style.opacity = "1";
            promptFloat.style.transform = "translateY(0)";
            promptFloat.style.transition = "";
            promptFloat.innerHTML = '<span id="promptText"></span><span class="prompt-caret"></span>';
            const promptText = document.getElementById("promptText");
            let pc = 0;
            const type = () => {
              if (promptText) promptText.textContent = word.slice(0, pc);
              pc++;
              if (pc <= word.length){
                setTimeout(type, 65);
              } else {
                setTimeout(() => {
                  promptFloat.style.transition = "transform 1.1s ease, opacity 1.1s ease";
                  promptFloat.style.transform = "translateY(-95px)";
                  promptFloat.style.opacity = "0";
                  setTimeout(() => {
                    pw = (pw + 1) % promptWordsUI.length;
                    runPrompt();
                  }, 1150);
                }, 420);
              }
            };
            type();
          }
          runPrompt();
        }

        // code typing on laptop
        const codeTypingEl = document.getElementById("codeTyping");
        if (codeTypingEl) {
          const codeLines = [
            "const idea = build('domain-store');",
            "git push origin main",
            "deploy('github-pages');",
            "pinTraffic -> landing -> GoDaddy"
          ];
          let lineIndex = 0, charIndex = 0;
          function typeLoop(){
            const line = codeLines[lineIndex];
            codeTypingEl.textContent = line.slice(0, charIndex);
            charIndex++;
            if (charIndex <= line.length) setTimeout(typeLoop, 42);
            else {
              setTimeout(() => {
                const erase = () => {
                  charIndex--;
                  codeTypingEl.textContent = line.slice(0, charIndex);
                  if (charIndex > 0) setTimeout(erase, 18);
                  else {
                    lineIndex = (lineIndex + 1) % codeLines.length;
                    setTimeout(typeLoop, 250);
                  }
                };
                erase();
              }, 700);
            }
          }
          typeLoop();
        }

        // focus mode + panels
        const cardDomains = document.getElementById("cardDomains");
        const cardContact = document.getElementById("cardContact");
        let timers = [];

        function clearTimers(){ timers.forEach(t => clearTimeout(t)); timers = []; }
        function resetAll(){
          clearTimers();
          document.body.classList.remove("focus-domains","focus-contact","domains-panel-on","domains-rise-on","contact-panel-on");
          const domainWall = document.getElementById("domainWall");
          const contactPanel = document.getElementById("contactPanel");
          if (domainWall) domainWall.setAttribute("aria-hidden","true");
          if (contactPanel) contactPanel.setAttribute("aria-hidden","true");
          if (bgPhoto) {
            document.body.classList.remove("domain-bg-on");
            bgPhoto.style.backgroundImage = "";
          }
        }

        if (cardDomains) {
          cardDomains.addEventListener("mouseenter", () => {
            resetAll();
            document.body.classList.add("focus-domains");

            timers.push(setTimeout(() => {
              document.body.classList.add("domains-panel-on");
              const domainWall = document.getElementById("domainWall");
              if (domainWall) domainWall.setAttribute("aria-hidden","false");
            }, 240));

            timers.push(setTimeout(() => {
              document.body.classList.add("domains-rise-on");
            }, 240 + 180));
          });
        }

        if (cardContact) {
          cardContact.addEventListener("mouseenter", () => {
            resetAll();
            document.body.classList.add("focus-contact");

            timers.push(setTimeout(() => {
              document.body.classList.add("contact-panel-on");
              const contactPanel = document.getElementById("contactPanel");
              if (contactPanel) contactPanel.setAttribute("aria-hidden","false");
            }, 120));
          });
        }

        document.addEventListener("mousemove", (e) => {
          const inside = e.target.closest("#stage, #domainWall, #contactPanel, #cardDomains, #cardContact");
          if (!inside) resetAll();
        });

        // click routes
        const cardPrompts = document.getElementById("cardPrompts");
        const cardCode = document.getElementById("cardCode");
        const cardExtension = document.getElementById("cardExtension");

        if (cardPrompts) {
          cardPrompts.addEventListener("click", () => window.location.href = "prompts/");
        }
        if (cardCode) {
          cardCode.addEventListener("click", () => window.location.href = "code/");
        }
        if (cardDomains) {
          cardDomains.addEventListener("click", () => window.location.href = "domains/");
        }
        if (cardExtension) {
          cardExtension.addEventListener("click", () => window.location.href = "extension/");
        }
      }

      // Initialize when DOM is ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initApp);
      } else {
        initApp();
      }
    })();
  </script>
</Layout>
